# 007: Day 21 Judgment Gateï¼ˆç¶™ç¶šåˆ¤æ–­å„€å¼ï¼‰

## æ¦‚è¦

Day 21ã®ç¶™ç¶šåˆ¤æ–­å„€å¼ã‚’å®Ÿè£…ã™ã‚‹ã€‚æ±ºæ¸ˆã§ã¯ãªãã€å¿ƒç†çš„å¥‘ç´„ã‚’æ›´æ–°ã™ã‚‹ã€Œé–€ï¼ˆGateï¼‰ã€ã¨ã—ã¦è¨­è¨ˆã€‚Commitment Reportã®è¡¨ç¤ºã€èª“ã„ã®æ›´æ–°ã€Tough Loveåˆæ„ã€ç¶™ç¶š/åœæ­¢ã®é¸æŠã‚’è¡Œã†ã€‚

## Phase

**Phase A: MVP**

## å„ªå…ˆåº¦

é«˜

## ä¾å­˜é–¢ä¿‚

- å‰æ: 003 ãƒ›ãƒ¼ãƒ ç”»é¢, 005 AIã‚³ãƒ¼ãƒ, 006 è¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ , 009 Evidence Journal, 010 Small Wins
- å¾Œç¶š: 008 èª²é‡‘ã‚·ã‚¹ãƒ†ãƒ , 012 Exit Ritualï¼ˆåŸºæœ¬ç‰ˆï¼‰

---

## æ©Ÿèƒ½è¦ä»¶

### 1. ä½“é¨“ã®åŸºæœ¬æ§‹é€ ï¼ˆå„€å¼è¨­è¨ˆï¼‰

1. **é™ã‹ãªå°å…¥ï¼ˆRitual Introï¼‰**
   - ã€Œã“ã“ã¾ã§æ¥ãŸäº‹å®Ÿã€ã‚’ã¾ãšæ‰¿èª

2. **é¡ã®æç¤ºï¼ˆThe Mirrorï¼‰**
   - 3é€±é–“ã®è¨¼æ‹ ã¨å¤‰åŒ–ã‚’å¯è¦–åŒ–

3. **èª“ã„ã®çµæ™¶åŒ–ï¼ˆVow Crystallizationï¼‰**
   - å¿—/èª“ã„ã‚’"ä»Šã®è¨€è‘‰"ã«æ›´æ–°

4. **å³ã—ã•ã¸ã®åˆæ„ï¼ˆConsent to Tough Loveï¼‰**
   - æœ‰æ–™æœŸã®ä»‹å…¥å¼·åº¦ã‚’åˆæ„

5. **ç¶™ç¶š/åœæ­¢ã®é¸æŠï¼ˆChoiceï¼‰**
   - ç¶™ç¶š = èª²é‡‘ç¢ºèªç”»é¢ã¸
   - åœæ­¢ = Exit Ritual ã¸

### 2. Commitment Reportï¼ˆå¿…é ˆè¡¨ç¤ºé …ç›®ï¼‰

**Evidencesï¼ˆç©ã¿ä¸Šã’ãŸè¨¼æ‹ ï¼‰:**
- Evidence Journalæå‡ºç‰©ä¸€è¦§
- AIãŒé¸ã¶ãƒã‚¤ãƒ©ã‚¤ãƒˆ3ã¤

**è¸ã¿ã¨ã©ã¾ã‚Šå›æ•°ï¼ˆResilience Countï¼‰:**
- è«¦ã‚ãã†ã«ãªã£ãŸæ™‚ã€è¸ã¿ã¨ã©ã¾ã£ãŸå›æ•°
- ç®—å‡ºæ ¹æ‹ ã‚’æ˜ç¤º

**å¿—ã®çµæ™¶åŒ–:**
- v1ï¼ˆåˆæœŸï¼‰â†’ v2ï¼ˆç¾åœ¨ï¼‰ã®å·®åˆ†è¡¨ç¤º
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†å¯

**AIãŒè¦‹ã¦ã„ã‚‹å¯èƒ½æ€§ï¼ˆPotential Statementï¼‰:**
- è¦³æ¸¬å¤‰åŒ–ãƒ»è¨¼æ‹ ã‹ã‚‰å°ãæ ¹æ‹ ä»˜ã

**è¡Œå‹•ç¶™ç¶šã‚¹ã‚³ã‚¢ï¼ˆProgress Trajectoryï¼‰:**
- ãƒ†ã‚£ã‚¢è¡¨ç¤ºï¼ˆOn Track / At Risk / Needs Resetï¼‰
- ç®—å‡ºæ ¹æ‹ ã®å®Œå…¨é–‹ç¤º
  - ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ç¶™ç¶šç‡
  - If-Thenç™ºå‹•ç‡
  - Evidenceæå‡ºç‡
  - ã‚³ãƒŸãƒƒãƒˆå±¥è¡Œç‡

**Tough Loveã®äºˆå…†:**
- ä»Šå¾Œã®èª²é¡Œã®çªãã¤ã‘
- ã€Œæœ‰æ–™æœŸé–“ã§ã¯å³ã—ãæŒ‡æ‘˜ã—ã¦ã„ã„ã§ã™ã‹ï¼Ÿã€ã®åˆæ„å•ã„

### 3. èª“ã„æ›´æ–°

- 3è¡Œã®å¿—ã‚’ç·¨é›†/ç¢ºå®š
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã«ä¿å­˜

### 4. ä»‹å…¥åˆæ„ï¼ˆTough Love Consentï¼‰

**ä»‹å…¥é ˜åŸŸï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ï¼‰:**
- é€ƒã’ç™–
- æ™‚é–“è¨€ã„è¨³
- æå‡ºç‰©
- é€¸è„±ä¼šè©±

**ä»‹å…¥å¼·åº¦ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼‰:**
- ç©ã‚„ã‹ / æ¨™æº– / å¼·ã‚
- äººæ ¼å¦å®šã¯ä¸å¯ï¼ˆèª¬æ˜è¡¨ç¤ºï¼‰

### 5. å¿ƒç†çš„å¥‘ç´„ã®å†ç½²å

```
ã€Œç§ã¯ã“ã®3ãƒ¶æœˆã§ã€[ä»Šã®è‡ªåˆ†]ã‚’å’æ¥­ã—ã€[ç†æƒ³ã®è‡ªåˆ†]ã«ãªã‚‹ã€
```
- ç½²åï¼ˆæŒ‡ã§ã‚µã‚¤ãƒ³ï¼‰

### 6. ç¶™ç¶š/åœæ­¢ã®é¸æŠ

**ç¶™ç¶šã®å ´åˆ:**
- æ±ºæ¸ˆç¢ºèªç”»é¢ã¸é·ç§»
- èª²é‡‘é¡è¡¨ç¤º
- ã€Œèª²é‡‘ã‚’ç¢ºå®šã™ã‚‹ã€ãƒœã‚¿ãƒ³

**åœæ­¢ã®å ´åˆ:**
- Exit Ritualï¼ˆå­¦ã³å›åï¼‰ã¸é·ç§»
- èª å®Ÿã«é–¢ä¿‚ã‚’é–‰ã˜ã‚‹

---

## UI/UXè¦ä»¶

### å„€å¼ãƒ‡ã‚¶ã‚¤ãƒ³ä»•æ§˜

**Ritual Transitionsï¼ˆå„€å¼çš„ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ï¼‰**
- ç”»é¢é·ç§»: **1.8s Ease-in-out**ï¼ˆé€šå¸¸ç”»é¢ã‚ˆã‚Šé•·ãã€å„€å¼æ„Ÿã‚’æ¼”å‡ºï¼‰
- Progressive Disclosure: æƒ…å ±ã¯æ®µéšçš„ã«è¡¨ç¤ºã€ä¸€åº¦ã«å¤šãã‚’è¦‹ã›ãªã„
- ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³: ã‚†ã£ãã‚Šã¨ã—ãŸå‡ºç¾ã§æ€è€ƒã«æ²ˆæ½œã•ã›ã‚‹

**Zazen Screenï¼ˆåç¦…ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ï¼‰**
- intro.tsx / re-sign.tsx ã§æ„å›³çš„ãªã€Œé–“ã€ã‚’è¨­ã‘ã‚‹
- å‘¼å¸ã‚’ä¿ƒã™ã‚ˆã†ãªç©ºç™½ã¨é™ã‘ã•
- ã€Œèª­ã¾ã›ã‚‹ã€ã‚ˆã‚Šã€Œæ„Ÿã˜ã•ã›ã‚‹ã€è¨­è¨ˆ

**ãƒãƒ—ãƒ†ã‚£ãƒƒã‚¯ï¼ˆè§¦è¦šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼‰**
- **Reflection Pulse**: 60bpmï¼ˆå¿ƒæ‹ã«è¿‘ã„ãƒªã‚ºãƒ ï¼‰ã§Reporté–²è¦§ä¸­ã«é™ã‹ãªæŒ¯å‹•
- **Vow Impact**: èª“ã„ç½²åæ™‚ã®å¼·ã„å˜ç™ºãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
- é¸æŠãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚: æ§ãˆã‚ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

**ã‚«ãƒ©ãƒ¼ãƒ»ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£**
- èƒŒæ™¯: Ecru #F7F3F0
- ã‚µãƒ¼ãƒ•ã‚§ã‚¹: Pearl #FAF8F5
- **ç‰¹åˆ¥ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ: Deep Gold #C9A961**ï¼ˆDay21å„€å¼ç”»é¢å°‚ç”¨ã€å³ã‹ã•ã‚’æ¼”å‡ºï¼‰
  - ä½¿ç”¨ç®‡æ‰€: èª“ã„å†ç½²åã®æ ç·šã€é‡è¦ãªè¦‹å‡ºã—ã€CTA
  - ä½¿ç”¨é‡: æœ€å°é™ï¼ˆColor Ratio 3%å†…ï¼‰
- è¦‹å‡ºã—: Noto Serif JP (Light) â€” å“æ ¼ã¨é™ã‘ã•
- æœ¬æ–‡: Noto Sans JP (Regular)
- Line Height: 1.9ã€œ2.1ï¼ˆæ—¥æœ¬èªã€Œé–“ã€ã‚’æ´»ã‹ã™ï¼‰
- Type-to-Space Ratio: 15:85

**ç¦æ­¢äº‹é …**
- æ´¾æ‰‹ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒã‚¦ãƒ³ã‚¹ã€ã‚·ã‚§ã‚¤ã‚¯ç­‰ï¼‰
- ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³çš„æ¼”å‡ºï¼ˆç´™å¹é›ªã€ã‚¹ã‚¿ãƒ¼ç­‰ï¼‰
- æ€¥ã‹ã™ã‚ˆã†ãªè¡¨ç¤ºï¼ˆã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ç­‰ï¼‰

### ç”»é¢ãƒ•ãƒ­ãƒ¼

```
(day21)/
â”œâ”€â”€ intro.tsx           # é™ã‹ãªå°å…¥
â”œâ”€â”€ report.tsx          # Commitment Report
â”œâ”€â”€ vow-update.tsx      # èª“ã„æ›´æ–°
â”œâ”€â”€ tough-love.tsx      # ä»‹å…¥åˆæ„
â”œâ”€â”€ re-sign.tsx         # å¿ƒç†çš„å¥‘ç´„å†ç½²å
â”œâ”€â”€ choice.tsx          # ç¶™ç¶š/åœæ­¢é¸æŠ
â”œâ”€â”€ payment-confirm.tsx # æ±ºæ¸ˆç¢ºèªï¼ˆç¶™ç¶šæ™‚ï¼‰
â””â”€â”€ exit.tsx            # Exit Ritualï¼ˆåœæ­¢æ™‚ï¼‰
```

### ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¾‹ï¼ˆReportç”»é¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  21æ—¥é–“ã‚’æŒ¯ã‚Šè¿”ã‚‹           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚
â”‚  ğŸ“Š ã‚ãªãŸã®è¡Œå‹•ç¶™ç¶š         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  On Track             â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚  ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³: 19/21   â”‚  â”‚
â”‚  â”‚  If-Thenç™ºå‹•: 8/12     â”‚  â”‚
â”‚  â”‚  Evidence: 5/6         â”‚  â”‚
â”‚  â”‚  ã‚³ãƒŸãƒƒãƒˆå±¥è¡Œ: 14/17   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚
â”‚  ğŸ’ª è¸ã¿ã¨ã©ã¾ã‚Šå›æ•°: 4å›    â”‚
â”‚                              â”‚
â”‚  âœ¨ è¨¼æ‹ ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ         â”‚
â”‚  â”œ 1æœˆ5æ—¥: æœ5æ™‚èµ·åºŠé”æˆ    â”‚
â”‚  â”œ 1æœˆ10æ—¥: ã‚³ãƒ¼ãƒ‰100è¡Œ     â”‚
â”‚  â”” 1æœˆ15æ—¥: èª˜æƒ‘ã«å‹ã£ãŸ    â”‚
â”‚                              â”‚
â”‚  ğŸ“ å¿—ã®é€²åŒ–                 â”‚
â”‚  v1: ã¼ã‚“ã‚„ã‚Šã—ãŸç›®æ¨™        â”‚
â”‚  â†“                           â”‚
â”‚  v2: 3è¡Œã«çµæ™¶åŒ–             â”‚
â”‚                              â”‚
â”‚           [æ¬¡ã¸]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ‡ãƒ¼ã‚¿è¨ˆç®—

### è¡Œå‹•ç¶™ç¶šãƒ†ã‚£ã‚¢åˆ¤å®š

```typescript
interface ProgressMetrics {
  checkinRate: number;      // ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ç¶™ç¶šç‡
  ifThenRate: number;       // If-Thenç™ºå‹•ç‡
  evidenceRate: number;     // Evidenceæå‡ºç‡
  commitmentRate: number;   // ã‚³ãƒŸãƒƒãƒˆå±¥è¡Œç‡
}

function calculateTier(metrics: ProgressMetrics): 'on_track' | 'at_risk' | 'needs_reset' {
  const avg = (
    metrics.checkinRate +
    metrics.ifThenRate +
    metrics.evidenceRate +
    metrics.commitmentRate
  ) / 4;

  if (avg >= 0.7) return 'on_track';
  if (avg >= 0.4) return 'at_risk';
  return 'needs_reset';
}
```

### è¸ã¿ã¨ã©ã¾ã‚Šå›æ•°

```typescript
function calculateResilienceCount(userId: string): number {
  // ä»¥ä¸‹ã‚’ã‚«ã‚¦ãƒ³ãƒˆ:
  // 1. ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã§ã€Œè«¦ã‚ãã†ã€ã€Œã‚„ã‚ãŸã„ã€ç­‰ã®å¾Œã«æˆ»ã£ã¦ããŸå›æ•°
  // 2. If-Thenç™ºå‹•å›æ•°
  // 3. é›¢è„±å¾Œå¾©å¸°ï¼ˆ2æ—¥ä»¥ä¸Šç©ºã„ã¦æˆ»ã£ãŸï¼‰å›æ•°
}
```

---

## APIè¨­è¨ˆ

### GET /api/day21/report

Day 21ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

**Response:**
```json
{
  "metrics": {
    "checkin_rate": 0.9,
    "if_then_rate": 0.67,
    "evidence_rate": 0.83,
    "commitment_rate": 0.82
  },
  "tier": "on_track",
  "resilience_count": 4,
  "evidence_highlights": [...],
  "vow_evolution": {
    "v1": "...",
    "v2": "..."
  },
  "potential_statement": "...",
  "tough_love_preview": "..."
}
```

### POST /api/day21/complete

Day 21ã®é¸æŠã‚’è¨˜éŒ²

**Request:**
```json
{
  "choice": "continue",
  "updated_vow": "æ›´æ–°ã•ã‚ŒãŸèª“ã„",
  "tough_love_settings": {
    "areas": ["é€ƒã’ç™–", "æ™‚é–“è¨€ã„è¨³"],
    "intensity": "standard"
  }
}
```

---

## Todo

### ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- [ ] å„ç¨®ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
- [ ] ãƒ†ã‚£ã‚¢åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯
- [ ] è¸ã¿ã¨ã©ã¾ã‚Šå›æ•°è¨ˆç®—
- [ ] AIã«ã‚ˆã‚‹Potential Statementç”Ÿæˆ
- [ ] Tough Loveäºˆå…†ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ

### ç”»é¢å®Ÿè£…
- [ ] intro.tsx - é™ã‹ãªå°å…¥
- [ ] report.tsx - Commitment Report
- [ ] vow-update.tsx - èª“ã„æ›´æ–°
- [ ] tough-love.tsx - ä»‹å…¥åˆæ„
- [ ] re-sign.tsx - å†ç½²å
- [ ] choice.tsx - ç¶™ç¶š/åœæ­¢é¸æŠ

### UI/UX
- [ ] ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- [ ] ãƒ†ã‚£ã‚¢è¡¨ç¤ºã‚«ãƒ¼ãƒ‰
- [ ] èª“ã„ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ 
- [ ] ä»‹å…¥è¨­å®šã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
- [ ] ç½²åã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### APIå®Ÿè£…
- [ ] GET /api/day21/report
- [ ] POST /api/day21/complete
- [ ] èª“ã„æ›´æ–°APIé€£æº

---

## å®Œäº†æ¡ä»¶

1. Day 21ã«è‡ªå‹•çš„ã«å„€å¼ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
2. è¡Œå‹•ç¶™ç¶šãƒ†ã‚£ã‚¢ã¨ç®—å‡ºæ ¹æ‹ ãŒè¡¨ç¤ºã•ã‚Œã‚‹
3. è¸ã¿ã¨ã©ã¾ã‚Šå›æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
4. èª“ã„ã‚’æ›´æ–°ã§ãã‚‹
5. Tough Loveè¨­å®šãŒã§ãã‚‹
6. ç¶™ç¶š/åœæ­¢ã‚’é¸æŠã§ãã‚‹
7. ç¶™ç¶šæ™‚ã¯æ±ºæ¸ˆç¢ºèªç”»é¢ã¸é·ç§»
8. åœæ­¢æ™‚ã¯Exit Ritualï¼ˆMVP: ç°¡æ˜“ç‰ˆï¼‰ã¸é·ç§»
