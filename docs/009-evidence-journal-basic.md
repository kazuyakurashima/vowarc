# 009: Evidence Journalï¼ˆåŸºæœ¬ç‰ˆï¼‰

## æ¦‚è¦

ç”»åƒãƒ»URLãƒ»ãƒ¡ãƒ¢ã‚’è¨¼æ‹ ï¼ˆEvidenceï¼‰ã¨ã—ã¦ä¿å­˜ã™ã‚‹åŸºæœ¬æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã€‚Day21ã®Commitment Reportã§è¡¨ç¤ºã™ã‚‹ãŸã‚ã®æœ€å°é™ã®å®Ÿè£…ã€‚

## Phase

**Phase A: MVP**

## å„ªå…ˆåº¦

é«˜

## ä¾å­˜é–¢ä¿‚

- å‰æ: 001 åŸºç›¤æ§‹ç¯‰, 006 è¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ 
- å¾Œç¶š: 007 Day21 Judgment Gate

---

## æ©Ÿèƒ½è¦ä»¶ï¼ˆMVPç‰ˆï¼‰

### 1. Evidence ã‚¿ã‚¤ãƒ—ï¼ˆMVPï¼‰

| ã‚¿ã‚¤ãƒ— | èª¬æ˜ | ä¾‹ |
|-------|------|-----|
| ç”»åƒï¼ˆImageï¼‰ | ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã€å†™çœŸ | å®Œæˆã—ãŸã‚³ãƒ¼ãƒ‰ã®ç”»é¢ |
| URL | å¤–éƒ¨ãƒªãƒ³ã‚¯ | ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã‚µã‚¤ãƒˆ |
| ãƒ¡ãƒ¢ï¼ˆNoteï¼‰ | ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ¢ | æ°—ã¥ãã€å­¦ã³ |

> éŸ³å£°Evidence ã¯ Phase B ã§è¿½åŠ 

### 2. åŸºæœ¬ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿

- ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆå¿…é ˆï¼‰
- æ—¥ä»˜ï¼ˆè‡ªå‹•ï¼‰
- ã‚¿ã‚¤ãƒ—ï¼ˆimage/url/noteï¼‰

> ã‚¿ã‚°ã€é–¢é€£ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã¯ Phase B ã§è¿½åŠ 

### 3. ã‚·ãƒ³ãƒ—ãƒ«ãªä¸€è¦§è¡¨ç¤º

- æ—¥ä»˜é †ã«è¨¼æ‹ ã‚’è¡¨ç¤º
- ã‚¿ã‚¤ãƒ—åˆ¥ã‚¢ã‚¤ã‚³ãƒ³
- ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤ºï¼ˆç”»åƒã®å ´åˆï¼‰

### 4. Day21é€£æº

- Evidenceä¸€è¦§ã‹ã‚‰ãƒã‚¤ãƒ©ã‚¤ãƒˆ3ã¤ã‚’AIãŒé¸å®š
- Commitment Reportã«è¡¨ç¤º

---

## UIè¨­è¨ˆï¼ˆMVPç‰ˆï¼‰

### Evidenceè¿½åŠ ãƒœã‚¿ãƒ³ï¼ˆãƒ›ãƒ¼ãƒ ã‹ã‚‰ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¨¼æ‹ ã‚’è¿½åŠ                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚
â”‚  [ğŸ“¸ ç”»åƒ] [ğŸ”— URL] [ğŸ“ ãƒ¡ãƒ¢] â”‚
â”‚                              â”‚
â”‚  ã‚¿ã‚¤ãƒˆãƒ«:                   â”‚
â”‚  [________________]          â”‚
â”‚                              â”‚
â”‚  å†…å®¹:                       â”‚
â”‚  [________________]          â”‚
â”‚  (URLã®å ´åˆã¯URLå…¥åŠ›)        â”‚
â”‚  (ãƒ¡ãƒ¢ã®å ´åˆã¯ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›)   â”‚
â”‚                              â”‚
â”‚           [ä¿å­˜ã™ã‚‹]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Evidenceä¸€è¦§ç”»é¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Evidence Journal   [+è¿½åŠ ]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚
â”‚  ğŸ“… 2024å¹´1æœˆ10æ—¥            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“¸ æœ5æ™‚èµ·åºŠé”æˆ       â”‚  â”‚
â”‚  â”‚    [ã‚µãƒ ãƒã‚¤ãƒ«]        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚
â”‚  ğŸ“… 2024å¹´1æœˆ8æ—¥             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ”— ãƒ–ãƒ­ã‚°è¨˜äº‹å…¬é–‹       â”‚  â”‚
â”‚  â”‚    https://...          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚
â”‚  ğŸ“… 2024å¹´1æœˆ5æ—¥             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“ èª˜æƒ‘ã«å‹ã£ãŸ         â”‚  â”‚
â”‚  â”‚    YouTubeã‚’è¦‹ãŸããªã£   â”‚  â”‚
â”‚  â”‚    ãŸã‘ã©æˆ‘æ…¢ã—ãŸ       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### evidences ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
CREATE TABLE evidences (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES users(id) NOT NULL,
  type VARCHAR(50) NOT NULL, -- 'image' | 'url' | 'note'
  title VARCHAR(200) NOT NULL,
  content TEXT, -- URL or note content
  file_url VARCHAR(500), -- for image
  date DATE DEFAULT CURRENT_DATE,
  created_at TIMESTAMP DEFAULT NOW()
);
```

---

## APIè¨­è¨ˆ

### GET /api/evidences

Evidenceä¸€è¦§ã‚’å–å¾—

**Query Parameters:**
- `limit`: ä»¶æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 20ï¼‰

**Response:**
```json
{
  "evidences": [
    {
      "id": "uuid",
      "type": "image",
      "title": "æœ5æ™‚èµ·åºŠé”æˆ",
      "file_url": "https://...",
      "date": "2024-01-10"
    }
  ]
}
```

### POST /api/evidences

Evidenceã‚’è¿½åŠ 

**Request (multipart/form-data for image):**
```
type: "image"
title: "æœ5æ™‚èµ·åºŠé”æˆ"
file: (binary)
```

**Request (JSON for url/note):**
```json
{
  "type": "url",
  "title": "ãƒ–ãƒ­ã‚°è¨˜äº‹å…¬é–‹",
  "content": "https://..."
}
```

### GET /api/evidences/highlights

Day21ç”¨ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’å–å¾—ï¼ˆAIé¸å®šï¼‰

**Response:**
```json
{
  "highlights": [
    { "id": "uuid", "title": "...", "date": "...", "reason": "..." }
  ]
}
```

---

## ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

### Supabase Storage

```typescript
async function uploadEvidence(
  userId: string,
  file: File
): Promise<string> {
  const fileName = `${userId}/${Date.now()}_${file.name}`;

  const { data, error } = await supabase.storage
    .from('evidences')
    .upload(fileName, file);

  if (error) throw error;

  const { data: urlData } = supabase.storage
    .from('evidences')
    .getPublicUrl(fileName);

  return urlData.publicUrl;
}
```

---

## Todo

### ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
- [ ] evidences ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
- [ ] RLSè¨­å®š
- [ ] Supabase Storage ãƒã‚±ãƒƒãƒˆä½œæˆ

### åŸºæœ¬æ©Ÿèƒ½
- [ ] Evidenceè¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ«
- [ ] ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- [ ] URLä¿å­˜æ©Ÿèƒ½
- [ ] ãƒ¡ãƒ¢ä¿å­˜æ©Ÿèƒ½

### ä¸€è¦§è¡¨ç¤º
- [ ] Evidenceä¸€è¦§ç”»é¢
- [ ] æ—¥ä»˜é †ã‚½ãƒ¼ãƒˆ
- [ ] ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤º

### APIå®Ÿè£…
- [ ] GET /api/evidences
- [ ] POST /api/evidences
- [ ] GET /api/evidences/highlights

### Day21é€£æº
- [ ] ãƒã‚¤ãƒ©ã‚¤ãƒˆé¸å®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆAIï¼‰
- [ ] Commitment Reportã¸ã®è¡¨ç¤º

---

## å®Œäº†æ¡ä»¶

1. ç”»åƒãƒ»URLãƒ»ãƒ¡ãƒ¢ã‚’Evidenceã¨ã—ã¦è¿½åŠ ã§ãã‚‹
2. ä¸€è¦§ç”»é¢ã§æ—¥ä»˜é †ã«è¡¨ç¤ºã•ã‚Œã‚‹
3. Day21ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆ3ã¤ãŒè¡¨ç¤ºã•ã‚Œã‚‹
4. ç”»åƒãŒSupabase Storageã«ä¿å­˜ã•ã‚Œã‚‹
